# Fix the package.json with correct comma placement and regenerate the ZIP
fixed_package_json = """
{
  "name": "baileys-whatsapp-bot",
  "version": "1.0.0",
  "main": "server.js",
  "type": "module",
  "scripts": {
    "start": "node server.js"
  },
  "dependencies": {
    "@whiskeysocket/baileys": "github:WhiskeySockets/Baileys",
    "express": "^4.18.2",
    "socket.io": "^4.7.2",
    "cors": "^2.8.5",
    "qrcode-terminal": "^0.12.0"
  }
}
"""

# Overwrite the existing package.json
fixed_path = "/mnt/data/baileys-whatsapp-bot/package.json"
with open(fixed_path, "w") as f:
    f.write(fixed_package_json.strip())

# Re-zip the project
fixed_zip_path = "/mnt/data/baileys-whatsapp-bot-fixed.zip"
with zipfile.ZipFile(fixed_zip_path, "w") as zipf:
    for root, _, files in os.walk(project_dir):
        for file in files:
            full_path = os.path.join(root, file)
            arcname = os.path.relpath(full_path, project_dir)
            zipf.write(full_path, arcname)

fixed_zip_path
